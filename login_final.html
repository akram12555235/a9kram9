<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(
          135deg,
          #667eea 0%,
          #764ba2 100%,
          #f093fb 100%
        );
        min-height: 100vh;
        display: flex;
        direction: rtl;
        position: relative;
        overflow: hidden;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 20% 50%,
            rgba(255, 255, 255, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(255, 255, 255, 0.05) 0%,
            transparent 50%
          );
        pointer-events: none;
        z-index: 0;
      }

      /* Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© Ù…Ø¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ */
      .top-header {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 100;
      }

      .profile-toggle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.5);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .profile-toggle:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.05);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      }

      /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ */
      .profile-menu {
        position: fixed;
        top: 80px;
        left: 20px;
        width: 280px;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.7);
        padding: 25px;
        max-height: 0;
        opacity: 0;
        overflow: hidden;
        transition: all 0.3s ease;
        pointer-events: none;
        z-index: 99;
      }

      .profile-menu.active {
        max-height: 600px;
        opacity: 1;
        pointer-events: all;
        animation: slideDown 0.3s ease-out;
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .profile-menu::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
        border-radius: 20px 20px 0 0;
      }

      .profile-header {
        text-align: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
      }

      .profile-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea, #764ba2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 36px;
        margin: 0 auto 12px;
        border: 3px solid #667eea;
        overflow: hidden;
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
      }

      .profile-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .profile-name {
        font-size: 18px;
        font-weight: 700;
        color: #333;
        margin-bottom: 4px;
      }

      .profile-username {
        font-size: 13px;
        color: #999;
        margin-bottom: 8px;
      }

      .profile-status {
        display: inline-block;
        padding: 4px 12px;
        background: #d4edda;
        color: #155724;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
      }

      .profile-info {
        margin-top: 20px;
      }

      .info-item {
        margin-bottom: 15px;
        padding-bottom: 12px;
        border-bottom: 1px solid #f0f0f0;
      }

      .info-item:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
      }

      .info-label {
        font-size: 12px;
        color: #999;
        font-weight: 600;
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .info-value {
        font-size: 14px;
        color: #333;
        font-weight: 600;
      }

      .info-value.email {
        word-break: break-all;
        font-size: 12px;
        color: #666;
      }

      .profile-actions {
        display: flex;
        gap: 10px;
        margin-top: 20px;
        padding-top: 15px;
        border-top: 2px solid #f0f0f0;
      }

      .profile-btn {
        flex: 1;
        padding: 10px;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .profile-btn.logout {
        background: #dc3545;
        color: white;
      }

      .profile-btn.logout:hover {
        background: #c82333;
        transform: translateY(-2px);
      }

      .profile-btn.dashboard {
        background: #667eea;
        color: white;
      }

      .profile-btn.dashboard:hover {
        background: #764ba2;
        transform: translateY(-2px);
      }

      .not-logged-in {
        text-align: center;
        padding: 20px;
      }

      .not-logged-in p {
        color: #999;
        font-size: 14px;
        margin-bottom: 10px;
      }

      /* Ø§Ù„Ø´Ù‚Ø© Ø§Ù„ÙŠÙ…ÙŠÙ† (Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ) */
      .website-section {
        flex: 1;
        padding: 60px 40px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start;
        color: white;
        position: relative;
        z-index: 1;
      }

      .website-section h1 {
        font-size: 56px;
        margin-bottom: 20px;
        font-weight: 800;
        text-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        animation: slideRight 0.8s ease-out;
      }

      .website-section .tagline {
        font-size: 20px;
        margin-bottom: 40px;
        opacity: 0.95;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        font-weight: 300;
        animation: slideRight 0.8s ease-out 0.1s both;
      }

      @keyframes slideRight {
        from {
          opacity: 0;
          transform: translateX(-40px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .features-list {
        list-style: none;
        margin-bottom: 40px;
      }

      .features-list li {
        padding: 15px 0;
        font-size: 16px;
        opacity: 0.9;
        display: flex;
        align-items: center;
        animation: slideRight 0.8s ease-out forwards;
        opacity: 0;
      }

      .features-list li:nth-child(1) {
        animation-delay: 0.2s;
      }
      .features-list li:nth-child(2) {
        animation-delay: 0.3s;
      }
      .features-list li:nth-child(3) {
        animation-delay: 0.4s;
      }
      .features-list li:nth-child(4) {
        animation-delay: 0.5s;
      }

      .features-list li::before {
        content: "â˜…";
        margin-right: 15px;
        font-size: 20px;
      }

      .cta-button {
        background: white;
        color: #667eea;
        padding: 16px 40px;
        border-radius: 10px;
        border: none;
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        animation: slideRight 0.8s ease-out 0.6s both;
      }

      .cta-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      }

      /* Ø§Ù„Ø´Ù‚Ø© Ø§Ù„ÙŠØ³Ø§Ø± (Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„) */
      .login-section {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px;
        position: relative;
        z-index: 1;
      }

      .login-container {
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(15px);
        padding: 50px;
        border-radius: 20px;
        width: 100%;
        max-width: 420px;
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.2),
          0 0 1px rgba(255, 255, 255, 0.5) inset;
        border: 1px solid rgba(255, 255, 255, 0.7);
        animation: slideUp 0.8s ease-out;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(40px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .login-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 5px;
        background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
        border-radius: 20px 20px 0 0;
      }

      .login-header {
        text-align: center;
        margin-bottom: 35px;
      }

      .login-header h2 {
        color: #333;
        font-size: 28px;
        margin-bottom: 8px;
        font-weight: 700;
      }

      .login-header p {
        color: #999;
        font-size: 14px;
      }

      .form-group {
        margin-bottom: 22px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #555;
        font-weight: 600;
        font-size: 14px;
      }

      .form-group input {
        width: 100%;
        padding: 14px 16px;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        font-size: 14px;
        font-family: inherit;
        transition: all 0.3s ease;
        background: #f8f9ff;
      }

      .form-group input:focus {
        outline: none;
        border-color: #667eea;
        background: white;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .form-group input::placeholder {
        color: #ccc;
      }

      .message {
        padding: 12px 16px;
        border-radius: 8px;
        margin-bottom: 20px;
        font-size: 14px;
        display: none;
        animation: slideDown 0.3s ease-out;
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .message.error {
        background: #fee;
        color: #c00;
        border-left: 4px solid #c00;
      }

      .message.success {
        background: #efe;
        color: #060;
        border-left: 4px solid #060;
      }

      .login-btn {
        width: 100%;
        padding: 14px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 10px;
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        margin-top: 10px;
        position: relative;
        overflow: hidden;
      }

      .login-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        transition: left 0.5s;
      }

      .login-btn:hover::before {
        left: 100%;
      }

      .login-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
      }

      .login-btn:active {
        transform: translateY(0);
      }

      .login-footer {
        text-align: center;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #e0e0e0;
      }

      .login-footer p {
        color: #666;
        font-size: 14px;
      }

      .login-footer a {
        color: #667eea;
        text-decoration: none;
        font-weight: 700;
        transition: all 0.2s;
      }

      .login-footer a:hover {
        color: #764ba2;
        text-decoration: underline;
      }

      @media (max-width: 1024px) {
        body {
          flex-direction: column;
        }

        .website-section {
          padding: 40px 30px;
          text-align: center;
          justify-content: center;
          min-height: 300px;
        }

        .website-section h1 {
          font-size: 40px;
        }

        .website-section .tagline {
          font-size: 18px;
        }

        .features-list li {
          justify-content: center;
        }

        .login-section {
          padding: 30px;
        }

        .login-container {
          max-width: 100%;
        }

        .profile-menu {
          left: 10px;
          right: 10px;
          width: auto;
        }
      }

      @media (max-width: 640px) {
        .website-section h1 {
          font-size: 32px;
        }

        .login-container {
          padding: 35px 25px;
        }

        .login-header h2 {
          font-size: 24px;
        }

        .profile-menu {
          width: calc(100% - 60px);
        }
      }
    </style>
  </head>
  <body>
    <!-- Ø²Ø± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ ÙÙŠ Ø§Ù„Ø²Ø§ÙˆÙŠØ© -->
    <div class="top-header">
      <div class="profile-toggle" id="profileToggle" title="Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ">
        ğŸ‘¤
      </div>
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ -->
    <div class="profile-menu" id="profileMenu">
      <div id="profileContent">
        <div class="not-logged-in">
          <p>Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ù†Ø´Ø·</p>
          <p style="font-size: 12px; color: #ccc">Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹</p>
        </div>
      </div>
    </div>

    <!-- Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙŠØ³Ø± - Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ -->
    <div class="website-section">
      <h1>ğŸ”— Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¨Ø«Ù‚Ø©</h1>
      <p class="tagline">Ù…Ù†ØµØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø¢Ù…Ù† ÙˆØ§Ù„Ø³Ù„Ø³</p>

      <ul class="features-list">
        <li>ğŸ” ØªØ´ÙÙŠØ± Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©</li>
        <li>âš¡ Ø³Ø±Ø¹Ø© ÙØ§Ø¦Ù‚Ø© ÙÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„</li>
        <li>ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„ Ù…ØªÙ‚Ø¯Ù…Ø©</li>
        <li>ğŸ“± Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</li>
      </ul>

      <button class="cta-button" onclick="window.location.href='welcome.html'">
        â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      </button>
    </div>

    <!-- Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙŠÙ…Ù† - Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div class="login-section">
      <div class="login-container">
        <div class="login-header">
          <h2>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
          <p>Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
        </div>

        <div id="message" class="message"></div>

        <form id="loginForm">
          <div class="form-group">
            <label for="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯</label>
            <input
              type="text"
              id="username"
              placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
              required
            />
          </div>

          <div class="form-group">
            <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input
              type="password"
              id="password"
              placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
              required
            />
          </div>

          <button type="submit" class="login-btn">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
        </form>

        <div class="login-footer">
          <p>Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="register.html">â† Ø§Ø·Ù„Ø¨ Ø¹Ø¶ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</a></p>
        </div>
      </div>
    </div>

    <script>
      const API_URL = "http://localhost:5000/api";

      // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
      function loadUserProfile() {
        const token = localStorage.getItem("token");
        const username = localStorage.getItem("username");
        const userId = localStorage.getItem("user_id");

        if (token && username && userId) {
          fetchUserData(userId, token);
        }
      }

      // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† API
      async function fetchUserData(userId, token) {
        try {
          const res = await fetch(`${API_URL}/user/profile`, {
            headers: { Authorization: token },
          });

          if (res.ok) {
            const user = await res.json();
            displayUserProfile(user);
          }
        } catch (e) {
          console.error("Error loading profile:", e);
        }
      }

      // Ø¹Ø±Ø¶ Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø´Ø®ØµÙŠ
      function displayUserProfile(user) {
        const profileContent = document.getElementById("profileContent");
        const avatarEmoji = user.full_name ? user.full_name.charAt(0) : "ğŸ‘¤";

        let profileHTML = `
                <div class="profile-header">
                    <div class="profile-avatar">
                        ${
                          user.profile_image &&
                          user.profile_image.startsWith("data:")
                            ? `<img src="${user.profile_image}" alt="${user.full_name}">`
                            : avatarEmoji
                        }
                    </div>
                    <div class="profile-name">${
                      user.full_name || user.username
                    }</div>
                    <div class="profile-username">@${user.username}</div>
                    <div class="profile-status">âœ“ Ù†Ø´Ø· Ø§Ù„Ø¢Ù†</div>
                </div>

                <div class="profile-info">
                    <div class="info-item">
                        <div class="info-label">ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
                        <div class="info-value email">${user.email}</div>
                    </div>

                    <div class="info-item">
                        <div class="info-label">ğŸ“ Ø§Ù„Ù†Ø¨Ø°Ø©</div>
                        <div class="info-value">${
                          user.bio || "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø¨Ø°Ø©"
                        }</div>
                    </div>

                    <div class="info-item">
                        <div class="info-label">ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</div>
                        <div class="info-value">${new Date(
                          user.created_at
                        ).toLocaleDateString("ar-SA")}</div>
                    </div>
                </div>

                <div class="profile-actions">
                    <button class="profile-btn dashboard" onclick="window.location.href='dashboard.html'">
                        Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                    </button>
                    <button class="profile-btn logout" onclick="logout()">
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                    </button>
                </div>
            `;

        profileContent.innerHTML = profileHTML;
      }

      // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
      function logout() {
        localStorage.removeItem("token");
        localStorage.removeItem("user_id");
        localStorage.removeItem("username");
        window.location.href = "welcome.html";
      }

      // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„
      document
        .getElementById("loginForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const username = document.getElementById("username").value.trim();
          const password = document.getElementById("password").value;

          if (!username || !password) {
            showMessage("âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„", "error");
            return;
          }

          try {
            const btn = document.querySelector(".login-btn");
            btn.disabled = true;
            btn.textContent = "â³ Ø¬Ø§Ø±Ù Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";

            const res = await fetch(`${API_URL}/auth/login`, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ username, password }),
            });

            const result = await res.json();

            if (res.ok) {
              localStorage.setItem("token", result.token);
              localStorage.setItem("user_id", result.user_id);
              localStorage.setItem("username", result.username);
              showMessage("âœ… ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ø¯ÙŠØ«...", "success");

              // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
              setTimeout(() => {
                loadUserProfile();
                document.getElementById("profileMenu").classList.add("active");
                showMessage("", "success");
              }, 1000);

              // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
              setTimeout(() => {
                window.location.href = "index.html";
              }, 2500);
            } else {
              const error = result.error || "ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
              if (error.includes("Ù…ÙˆØ§ÙÙ‚Ø©") || error.includes("Ù…Ø¹Ù„Ù‚Ø©")) {
                showMessage(
                  "â³ Ø­Ø³Ø§Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©\nÙŠØ±Ø¬Ù‰ Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
                  "error"
                );
              } else {
                showMessage("âŒ " + error, "error");
              }
              btn.disabled = false;
              btn.textContent = "Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†";
            }
          } catch (e) {
            showMessage("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: " + e.message, "error");
            document.querySelector(".login-btn").disabled = false;
            document.querySelector(".login-btn").textContent = "Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†";
          }
        });

      function showMessage(msg, type) {
        const div = document.getElementById("message");
        div.textContent = msg;
        div.className = "message " + type;
      }

      // ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
      document
        .getElementById("profileToggle")
        .addEventListener("click", function () {
          const menu = document.getElementById("profileMenu");
          menu.classList.toggle("active");
        });

      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
      document.addEventListener("click", function (e) {
        const menu = document.getElementById("profileMenu");
        const toggle = document.getElementById("profileToggle");

        if (!menu.contains(e.target) && !toggle.contains(e.target)) {
          menu.classList.remove("active");
        }
      });

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
      loadUserProfile();
    </script>
  </body>
</html>
